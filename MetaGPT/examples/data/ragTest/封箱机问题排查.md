# 封箱机问题排查

1. **端侧显示件烟内五十条均为NG**：
   1.排查是否端侧报警信息包含人工放烟，如果是，则需要排查是否有人工放烟，如果没有人工放烟，则通过日志排查是否最后一次件推信号丢失，如果是，协调电气同时排查为什么最后一次件推信号没有触发。
   2.排查是否端侧报警信息包含件推信号紊乱,条烟全部赋值NG，如果有，则需要排查件推信号为什么和正常的件推信号不一致，此过程需要协调电气同事一起排查。
   3.排查日志查看是否一个件烟周期内件推信号数量和算法配置文件中的件推数量不一致，然后根据现场安装的件推信号传感器数量正确在算法文件中配置所需的件推数量。

2. **件烟内条烟有25条烟的条烟码为NG，其余25条烟的条烟码为正常条烟码**
    1.排查日志查看一个件烟周期内是否存在三次条推：可以通过封箱机日志和封箱机数据库的事件表来进行排查，查看当前件烟的所有信号中是否存在条推信号多了的情况。如果存在则考虑是否为人工掏烟不规范，或者原机条推信号误触发，或者是否原机故障导致卡烟出现三次条推的情况。
    2.排查是否因为PLC的信号发送辅助功能打开，导致条推出现问题。如果有，需要关闭PLC辅助功能。
    3.排查是否机型为YP18或YP18B且没有增加三推信号，当烟机生产速度过快时则会出现25条NG的情况

3. **边侧显示件烟内50条NG**
    1.排查对应端侧的日志和数据库信号表，判断是否件推信号紊乱导致的件烟关联错位，可以参照关联正常的件烟的件推顺序。
    2.排查是否由于件烟通道太短导致处理异常件烟是会触发件烟读码，可以考虑增加四推信号来解决问题。

4. **读码器读码，但是端侧没数据**
    1.排查算法配置文件中读码器配置是否和实际配置一致，如果不一致则需要按照现场读码器安装方案进行配置。
    2.排查读码器硬件，可以通过读码器配置软件观察读码器是否读码，读码器读到的条烟码数据是否传到上位机。如果读码器硬件有问题可以通过重置读码器或者更换读码器来解决。
    3.检查读码器IP和端口以及相关配置文件进行排查，如果有配置错误，则需要按照实际ip地址和端口进行配置

5. **端侧报警当前件烟码于打码机反馈数据不匹配**
    1.排查端侧当前班次生产的条烟品规和实际生产的条烟品规是否一致，如果不一致，按照现场生产需求正确配置品规信息。
    2.排查是否件烟内有一条烟的品规和当前生产的条烟品规不一致，如果是，则将异常品规的条烟按照现场要求进行处理，并替换一条正确品规的条烟进行条件关联

6. **查看日志显示前一件烟关联到了后一件烟的5条烟**
    1.排查是否算法配置文件中的允许堆积层数于实际可允许的堆积层数不一致，如果不一致，需要按照实际情况配置。
    2.排查是否读码层数和实际读码层数不一致，不过不一致则需要按照实际情况配置。

7. **PLC 未收到件烟状态信息 剔除**
    1.排查是否人工在异常件烟取走传感器前取走了件烟。如果是需要规范操作流程，件烟从堆叠出来到异常件烟传感之间，不允许放入和拿走件烟。
    2.排查件烟读码器是否为单个触发，并且解码超时过长。解决办法为将件烟读码器配置成连续触发方式
    3.排查是否件烟读码工位传感器和读码器出现了故障。解决办法为：读码器故障考虑重置或更换；传感器故障考虑更换传感器
    4.排查是否异常件烟停留信号比件烟读码信号早。解决办法为：PLC程序开启信号发送辅助功能
    5.排查是否件烟读码传感器和异常件烟停留传感器误触发。解决办法为：规范人工操作
    6.排查是否PLC定时器的时间是默认的。解决办法为：修改件烟读码传感器触发后件烟剔除时间配置时间：具体为件烟触发件烟读码传感器到当前件烟触发异常件烟传感器的时间上下浮动100ms左右即可

8. **条推信号异常**
    1.是否条推信号多触发：排查是否是否有人工掏烟（指的是烟已经被推进烟箱了，又从堆叠处掏了出来）解决办法为：规范人工操作，可以把该件烟放到件烟关联后在进行人工处理（关联异常使用封箱机操作，关联正常使用pda进行操作）
    2.是否第三次条推的时候一推箱还没有触发，导致一件烟的三次条推。解决办法为：将一推信号改为箱满信号，保证在两次条推后可以及时触发一推箱信号
    3.是否条推信号少了。需要排查条推信号传感器是否存在异常。
    4.两个条推之间的堆叠次数分别为6次和4次。原因是条推信号延迟了。将条推信号辅助由1改为2

9. **件烟剔除功能无法正常使用**
    1.如果异常件烟未剔除：
   
   - 是否件烟读码器位置和异常件烟停留传感器位置过近。如果是需要调整读码器和件烟读码传感器位置，保证件烟码读不到的时候有足够反应时间
   
   - 是否异常件烟停留传感器信号未触发。如果是考虑传感器损坏，需要更换传感器
   
   - 排查是否PLC输出点Q1.1故障，PLCQ1.1输出点一直输出24V。如果是将PLC输出点Q1.1更换为Q2.7
     2.如果异常件烟剔除了：
     
     - 是否件烟传送带读码时不停，未拍到的不剔除。是否有改动件烟读码传感器和异常传感器位置，导致异常件烟停止功能失效。如果是将改动传感器复原原来位置，修改件烟读码参数（开始延迟读码时间）
     
     - 是否件烟可以剔除但会延迟剔除。如果是排查是否件烟读码超时时间太长。需要将件烟读码超时时间设置到合理时间。
     
     - 件烟剔除处会堵烟，下一件没读到码的话，会触发剔除传感器，导致通道卡烟，无法剔除下一件烟。如果是将件烟到达剔除位置传感器往烟来的方向移一定距离，避免堵烟时会触发传感器。
       
       
       
       
       
       
       
       
       
       
       
       
